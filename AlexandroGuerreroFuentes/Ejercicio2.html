<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Examen</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <style>
        body{padding: 20px;}
    </style>
</head>
  <body>
    <h1>Air pollution API</h1>
    <br>
    <div> Introduce la latitud:</div>
    
    <input type="text" id="latitud">
    <br> <br>

    <div> Introduce la longitud:</div>
    <input type="text" id="longitud">
    <br> <br>
    <button id="enviar"> Enviar </button>
    
    <div id="respuesta"></div>

<script>
    $(document).ready(function (){
        $("#enviar").click(function(){
            $("#respuesta").empty()
                let apikey = "f5b5e874d197efc0fc1b9c59f039c190"
                let url = "http://api.openweathermap.org/data/2.5/air_pollution?"
                let latitud = $("#latitud").val()
                let longitud =$("#longitud").val()
            if(latitud == "" && longitud == ""){$("#respuesta").html("Debe rellenar los dos campos") }
                else{
                    
                let url_completa = url + "lat="+latitud + "&lon=" + longitud + "&appid=" + apikey

                $.get(url_completa).done(function(api){
                console.log(api)
                if(api.list[0].main.aqi == 0){
                    $("#respuesta").css("background-color", "green")
                    .append(
                     "<br>"   +
                    "<div id='box'>" +
                        "<p> Calidad del aire: Bueno </p>" + 
                        "<p> Cantidad monoxido de carbono: "+ api.list[0].components.co + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de dioxido de azufre (SO<sub>2</sub>): "+ api.list[0].components.so2 + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de particulas finas (PM<sub>2.5</sub>): "+ api.list[0].components.pm2_5 + " µg/m<sup>3</sup> </p>" +
                   "</div>"
                    )}
                    
                    if(api.list[0].main.aqi == 1){
                    $("#respuesta").css("background-color", "yellow")
                    .append(
                     "<br>"   +
                    "<div id='box'>" +
                        "<p> Calidad del aire: Aceptable </p>" + 
                        "<p> Cantidad monoxido de carbono: "+ api.list[0].components.co + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de dioxido de azufre (SO<sub>2</sub>): "+ api.list[0].components.so2 + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de particulas finas (PM<sub>2.5</sub>): "+ api.list[0].components.pm2_5 + " µg/m<sup>3</sup> </p>" +
                   "</div>"
                    )}
                    

                    if(api.list[0].main.aqi == 2){
                    $("#respuesta").css("background-color", "orange")
                    .append(
                     "<br>"   +
                    "<div id='box'>" +
                        "<p> Calidad del aire: Moderado </p>" + 
                        "<p> Cantidad monoxido de carbono: "+ api.list[0].components.co + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de dioxido de azufre (SO<sub>2</sub>): "+ api.list[0].components.so2 + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de particulas finas (PM<sub>2.5</sub>): "+ api.list[0].components.pm2_5 + " µg/m<sup>3</sup> </p>" +
                   "</div>"
                    )}
                    
                    if(api.list[0].main.aqi == 3){
                    $("#respuesta").css("background-color", "purple")
                    .append(
                     "<br>"   +
                    "<div id='box'>" +
                        "<p> Calidad del aire: Malo </p>" + 
                        "<p> Cantidad monoxido de carbono: "+ api.list[0].components.co + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de dioxido de azufre (SO<sub>2</sub>): "+ api.list[0].components.so2 + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de particulas finas (PM<sub>2.5</sub>): "+ api.list[0].components.pm2_5 + " µg/m<sup>3</sup> </p>" +
                   "</div>"
                    )}
                    
                    if(api.list[0].main.aqi == 4){
                    $("#respuesta").css("background-color", "red")
                    .append(
                     "<br>"   +
                    "<div id='box'>" +
                        "<p> Calidad del aire: Muy malo </p>" + 
                        "<p> Cantidad monoxido de carbono: "+ api.list[0].components.co + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de dioxido de azufre (SO<sub>2</sub>): "+ api.list[0].components.so2 + " µg/m<sup>3</sup> </p>" +
                        "<p> Cantidad de particulas finas (PM<sub>2.5</sub>): "+ api.list[0].components.pm2_5 + " µg/m<sup>3</sup> </p>" +
                   "</div>"
                    )}
                    
        })
        .fail(function (){$("#respuesta").text("Ha habido un error")   })
    }
        }) //click
    
    })

    
</script>
  </body>
</html>